-------------------------------------------------------------------------
Initial REXX INFILE on 23 Mar 2025 at 10:43:20
-------------------------------------------------------------------------
0001 /*REXX program  validates  credit card numbers  using  the    Luhn    algorithm.        */
0002 #.=;                #.1= 49927398716             /*the  1st  sample credit card number. */
0003 #.2= 49927398717             /* "   2nd     "      "     "     "    */
0004 #.3= 1234567812345678        /* "   3rd     "      "     "     "    */
0005 #.4= 1234567812345670        /* "   4th     "      "     "     "    */
0006 do k=1  while #.k\==''                     /*validate all the credit card numbers.*/
0007 say right( Luhn(#.k), 9)          ' the Luhn test, credit card number: '    #.k
0008 end   /*k*/                                /* [↑] function returns passed│flunked.*/
0009 exit                                             /*stick a fork in it,  we're all done. */
0010 /*──────────────────────────────────────────────────────────────────────────────────────*/
0011 Luhn: procedure;  parse arg x;              $= 0 /*get credit card number;  zero $ sum. */
0012 y= reverse( left(0, length(x) // 2)x)      /*add leading zero if needed, reverse. */
0013 do j=1  to length(y)-1  by 2;                _= substr(y, j+1, 1) * 2
0014 $= $ + substr(y, j, 1) + left(_, 1) + substr(_, 2, 1, 0)     /* ◄────────┐*/
0015 end   /*j*/                       /*sum odd and even decimal digits ►────┘*/
0016 return word('passed flunked',1+($//10==0)) /*$ ending in zero?  Then the # passed.*/
-------------------------------------------------------------------------
Cross Reference Table Solid Variable Names
-------------------------------------------------------------------------
001 x                11
002 y                12
003 j                13
-------------------------------------------------------------------------
Cross Reference Table Bizarre Variable Names
-------------------------------------------------------------------------
001 #.               -> newV1.           2 2 3 4 5
002 $                -> newV2            11 14
003 _                -> newV3            13
