-------------------------------------------------------------------------
Initial REXX INFILE on 23 Mar 2025 at 10:43:23
-------------------------------------------------------------------------
0001 /* REXX ***************************************************************
0002 * 09.11.2012 Walter Pachl  translates from PL/I
0003 **********************************************************************/
0004 fid='rpl.txt'
0005 ex=linein(fid)
0006 Say 'Input:' ex
0007 /* ex=' 3 4 2 * 1 5 - 2 3 ^ ^ / +' */
0008 Numeric Digits 15
0009 expr=''
0010 st.=0
0011 Say 'Stack contents:'
0012 do While ex<>''
0013 Parse Var ex ch +1 ex
0014 expr=expr||ch;
0015 if ch<>' ' then do
0016 select
0017 When pos(ch,'0123456789')>0 Then Do
0018 Call stack ch
0019 Iterate
0020 End
0021 when ch='+' Then do; operand=getstack(); st.sti = st.sti +  operand; end;
0022 when ch='-' Then do; operand=getstack(); st.sti = st.sti -  operand; end;
0023 when ch='*' Then do; operand=getstack(); st.sti = st.sti *  operand; end;
0024 when ch='/' Then do; operand=getstack(); st.sti = st.sti /  operand; end;
0025 when ch='^' Then do; operand=getstack(); st.sti = st.sti ** operand; end;
0026 end;
0027 call show_stack
0028 end
0029 end
0030 Say 'The reverse polish expression = 'expr
0031 Say 'The evaluated expression = 'st.1
0032 Exit
0033 stack: Procedure Expose st.
0034 /* put the argument on top of the stack */
0035 z=st.0+1
0036 st.z=arg(1)
0037 st.0=z
0038 Return
0039 getstack: Procedure Expose st. sti
0040 /* remove and return the stack's top element */
0041 z=st.0
0042 stk=st.z
0043 st.0=st.0-1
0044 sti=st.0
0045 Return stk
0046 show_stack: procedure Expose st.
0047 /* show the stack's contents */
0048 ol=''
0049 do i=1 To st.0
0050 ol=ol format(st.i,5,10)
0051 End
0052 Say ol
0053 Return
-------------------------------------------------------------------------
Cross Reference Table Solid Variable Names
-------------------------------------------------------------------------
001 ex               13 13
002 ch               13
003 expr             14
004 operand          21 22 23 24 25
005 st.              21 22 23 24 25 36 37 43
006 z                35 41
007 stk              42
008 sti              44
009 ol               48 50
010 i                49
-------------------------------------------------------------------------
Cross Reference Table Bizarre Variable Names
-------------------------------------------------------------------------
