-------------------------------------------------------------------------
Initial REXX INFILE on 23 Mar 2025 at 10:43:25
-------------------------------------------------------------------------
0001 /*REXX*/
0002 
0003 Call time 'R'
0004 Do x=1 To 10
0005 Say x '->' proper_divisors(x)
0006 End
0007 
0008 hi=1
0009 Do x=1 To 20000
0010 /* If x//1000=0 Then Say x */
0011 npd=count_proper_divisors(x)
0012 Select
0013 When npd>hi Then Do
0014 list.npd=x
0015 hi=npd
0016 End
0017 When npd=hi Then
0018 list.hi=list.hi x
0019 Otherwise
0020 Nop
0021 End
0022 End
0023 
0024 Say hi '->' list.hi
0025 
0026 Say ' 166320 ->' count_proper_divisors(166320)
0027 Say '1441440 ->' count_proper_divisors(1441440)
0028 
0029 Say time('E') 'seconds elapsed'
0030 Exit
0031 
0032 proper_divisors: Procedure
0033 Parse Arg n
0034 If n=1 Then Return ''
0035 pd=''
0036 /* Optimization reduces 37 seconds to 28 seconds */
0037 If n//2=1 Then  /* odd number  */
0038 delta=2
0039 Else            /* even number */
0040 delta=1
0041 Do d=1 To n%2 By delta
0042 If n//d=0 Then
0043 pd=pd d
0044 End
0045 Return space(pd)
0046 
0047 count_proper_divisors: Procedure
0048 Parse Arg n
0049 Return words(proper_divisors(n))
-------------------------------------------------------------------------
Cross Reference Table Solid Variable Names
-------------------------------------------------------------------------
001 n                48
-------------------------------------------------------------------------
Cross Reference Table Bizarre Variable Names
-------------------------------------------------------------------------
