-------------------------------------------------------------------------
Initial REXX INFILE on 23 Mar 2025 at 10:43:20
-------------------------------------------------------------------------
0001 /*REXX program implements  main step   GOST 28147-89   based on a Feistel network.      */
0002 numeric digits 12                          /*  ┌── a list of 4─bit S─box values used by */
0003 /*  ↓ the Central Bank of Russian Federation.*/
0004 @.0  =     4  10   9   2  13   8   0  14   6  11   1  12   7  15   5   3
0005 @.1  =    14  11   4  12   6  13  15  10   2   3   8   1   0   7   5   9
0006 @.2  =     5   8   1  13  10   3   4   2  14  15  12   7   6   0   9  11
0007 @.3  =     7  13  10   1   0   8   9  15  14   4   6  12  11   2   5   3
0008 @.4  =     6  12   7   1   5  15  13   8   4  10   9  14   0   3  11   2
0009 @.5  =     4  11  10   0   7   2   1  13   3   6   8   5   9  12  15  14
0010 @.6  =    13  11   4   1   3  15   5   9   0  10  14   7   6   8   2  12
0011 @.7  =     1  15  13   0   5   7  10   4   9   2   3  14   6  11   8  12
0012 /* [↓]  build the sub-keys array from above. */
0013 do r=0  for 8;     do c=0  for 16;        !.r.c=word(@.r, c + 1);     end;    end
0014 z=0
0015 #1=x2d( 43b0421 );     #2=x2d( 4320430 );                         k=#1 + x2d( 0e2c104f9 )
0016 do  while  k > x2d( 7ffFFffF );       k=k - 2**32;     end
0017 do  while  k < x2d( 80000000 );       k=k + 2**32;     end
0018 
0019 do j=0  for 4;   jj=j + j;        jjp=jj + 1   /*calculate the array'a  "subscripts". */
0020 $=x2d( right( d2x( k % 2 ** (j * 8) ),  2) )
0021 cm=$ // 16;       cd=$ % 16        /*perform modulus and integer division.*/
0022 z=z + (!.jj.cm  +  16 * !.jjp.cd)  *  2**(j*8)
0023 end   /*i*/                                    /* [↑]  encryption algorithm for S-box.*/
0024 /* [↓]  encryption algorithm round.    */
0025 k = c2d( bitxor( bitor( d2c(z * 2**11,  4),    d2c(z % 2**21,  4) ),     d2c(#2, 4) ) )
0026 say  center(d2x(k)     ' '    d2x(#1), 79)       /*stick a fork in it,  we're all done. */
-------------------------------------------------------------------------
Cross Reference Table Solid Variable Names
-------------------------------------------------------------------------
001 r                13
002 c                13
003 z                14 22
004 k                15 16 17 25
005 j                19
006 jj               19
007 jjp              19
008 cm               21
009 cd               21
-------------------------------------------------------------------------
Cross Reference Table Bizarre Variable Names
-------------------------------------------------------------------------
001 @.               -> newV1.           4 5 6 7 8 9 10 11
002 !.               -> newV2.           13
003 #1               -> newV3            15
004 #2               -> newV4            15
005 $                -> newV5            20
