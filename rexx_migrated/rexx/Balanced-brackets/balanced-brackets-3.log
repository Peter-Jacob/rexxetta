-------------------------------------------------------------------------
Initial REXX INFILE on 23 Mar 2025 at 10:43:06
-------------------------------------------------------------------------
0001 /*REXX program checks for around 125,000 generated balanced brackets expressions  [ ]   */
0002 bals=0
0003 #=0;      do j=1  until  L>20                    /*generate lots of bracket permutations*/
0004 q=translate( strip( x2b( d2x(j) ), 'L', 0),  "][", 01)        /*convert ──► ][*/
0005 L=length(q)
0006 if countStr(']', q) \== countstr('[', q)  then iterate        /*not compliant?*/
0007 #=#+1                                                         /*bump legal Q's*/
0008 !=0;     do k=1  for L;      parse var q ? 2 q
0009 if ?=='['  then     !=!+1
0010 else do; !=!-1;  if !<0  then iterate j;  end
0011 end   /*k*/
0012 
0013 if !==0  then bals=bals+1
0014 end  /*j*/                             /*done all 20─character possibilities? */
0015 
0016 say #   " expressions were checked, "     bals    ' were balanced, ' ,
0017 #-bals    " were unbalanced."
0018 exit                                             /*stick a fork in it,  we're all done. */
0019 /*──────────────────────────────────────────────────────────────────────────────────────*/
0020 countStr: procedure;   parse arg n,h,s;    if s==''  then s=1;       w=length(n)
0021 do r=0  until _==0;   _=pos(n,h,s);   s=_+w;   end;      return r
-------------------------------------------------------------------------
Cross Reference Table Solid Variable Names
-------------------------------------------------------------------------
001 n                20
002 h                20
003 s                20 20 21
004 w                20
005 r                21
-------------------------------------------------------------------------
Cross Reference Table Bizarre Variable Names
-------------------------------------------------------------------------
001 #                -> newV1            3 7
002 !                -> newV2            8 9 10
003 ?                -> newV3            8
004 _                -> newV4            21
