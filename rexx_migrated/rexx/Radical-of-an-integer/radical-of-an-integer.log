-------------------------------------------------------------------------
Initial REXX INFILE on 23 Mar 2025 at 10:43:25
-------------------------------------------------------------------------
0001 /* REXX */
0002 call setp
0003 Numeric Digits 100
0004 /* 1. Radicals from 1 to 50 */
0005 Say 'Radicals of 1..50:'
0006 ol=''
0007 Do n=1 To 50
0008 ol=ol||right(rad(n),5)
0009 If n//10=0 then Do
0010 Say ol
0011 ol=''
0012 End
0013 End
0014 
0015 Say ''
0016 Call radt 99999
0017 Call radt 499999
0018 Call radt 999999
0019 
0020 Say ''
0021 Say 'Distribution of radicals:'
0022 Call time 'R'
0023 cnt.=0
0024 Do v=1 To 1000000
0025 If v//100000=1 Then Do
0026 ti=v%100000
0027 etime.ti=format(time('E'),4,1)
0028 End
0029 p=rad(v,'cnt')
0030 cnt.p+=1
0031 /**************************************
0032 If p=7 Then
0033 Say v':' rad(v,'lstx') '=' rad(v)
0034 **************************************/
0035 End
0036 etime.10=format(time('E'),4,1)
0037 Do d=0 To 20
0038 If cnt.d>0 Then
0039 Say d':' right(cnt.d,8)
0040 End
0041 Say ''
0042 Say 'Timings:'
0043 Do ti=1 To 10
0044 Say right(ti,2) etime.ti 'seconds'
0045 End
0046 Exit
0047 
0048 radt:
0049 Parse Arg u
0050 Say 'The radical of' u 'is' rad(u)'.'
0051 Return
0052 
0053 rad:
0054 Parse Arg z,what
0055 zz=z
0056 plist=''
0057 exp.=0
0058 Do Until p*p>z
0059 Do pi=1 By 1 Until p*p>z
0060 p=word(primzahlen,pi)
0061 exp.p=0
0062 Do while z//p=0
0063 exp.p+=1
0064 If pos(p,plist)=0 Then
0065 plist=plist p
0066 z=z%p
0067 End
0068 End
0069 End
0070 exp.z+=1
0071 If pos(z,plist)=0 &z<>1 Then
0072 plist=plist z
0073 Select
0074 When what='lst' Then
0075 Return plist
0076 When what='lstx' Then Do
0077 s=''
0078 Do While plist<>''
0079 Parse Var plist p plist
0080 if exp.p=1 Then
0081 s=s'*'p
0082 Else
0083 s=s'*'p'**'exp.p
0084 End
0085 Return strip(s,,'*')
0086 End
0087 When what='cnt' Then
0088 Return words(plist)
0089 Otherwise Do
0090 rad=1
0091 Do while plist>''
0092 Parse Var plist p plist
0093 rad=rad*p
0094 End
0095 Return rad
0096 End
0097 End
0098 
0099 setp:
0100 primzahlen=,
0101 2 3 5 7 11 13 17 19 23 29 31 37 41 43 47 53 59 61 67 71 73 79 83 89 97 101,
0102 103 107 109 113 127 131 137 139 149 151 157 163 167 173 179 181 191 193 197,
0103 199 211 223 227 229 233 239 241 251 257 263 269 271 277 281 283 293 307 311,
0104 313 317 331 337 347 349 353 359 367 373 379 383 389 397 401 409 419 421 431,
0105 433 439 443 449 457 461 463 467 479 487 491 499 503 509 521 523 541 547 557,
0106 563 569 571 577 587 593 599 601 607 613 617 619 631 641 643 647 653 659 661,
0107 673 677 683 691 701 709 719 727 733 739 743 751 757 761 769 773 787 797 809,
0108 811 821 823 827 829 839 853 857 859 863 877 881 883 887 907 911 919 929 937,
0109 941 947 953 967 971 977 983 991 997 1009 1013 1019 1021 1031 1033 1039 1049
0110 Return
-------------------------------------------------------------------------
Cross Reference Table Solid Variable Names
-------------------------------------------------------------------------
001 plist            92 92
002 p                92
003 rad              93
004 primzahlen       100
-------------------------------------------------------------------------
Cross Reference Table Bizarre Variable Names
-------------------------------------------------------------------------
