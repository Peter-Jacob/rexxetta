-------------------------------------------------------------------------
Initial REXX INFILE on 23 Mar 2025 at 10:43:10
-------------------------------------------------------------------------
0001 /*REXX program reads a CSV file & appends a SUM column (which is the sum of all columns)*/
0002 parse arg iFID .                                  /*obtain optional argument from the CL*/
0003 if iFID=='' | iFID==","  then iFID= 'CSV_SUM.DAT' /*Not specified?  Then use the default*/
0004 call linein iFID,1,0                              /*position the input file to line one.*/
0005 /* [↑]  only needed if pgm is nested. */
0006 do rec=1  while lines(iFID)\==0               /*read the input file  (all records). */
0007 x= linein(iFid);     y= translate(x, , ',')   /*read a rec; change commas to blanks.*/
0008 $= 0                                          /*initial the sum to zero.            */
0009 do j=1  for words(y);     _= word(y, j)    /*get a CSV value.  */
0010 if datatype(_, 'N')  then $= $ + _         /*Numeric? Add to $.*/
0011 else $= 'SUM'         /*Not? Append "SUM".*/
0012 end   /*j*/
0013 @.rec = x','$                                 /*append the   sum   to the record.   */
0014 end   /*rec*/                                 /*Note: at EOF,  REC ≡ # of records+1.*/
0015 say rec-1    ' records read from: '      iFID     /* [↓]  this elides the need for ERASE*/
0016 call lineout iFID,@.1,1                           /*set file ptr to 1st rec., write hdr.*/
0017 do k=2  for rec-2        /*process all the records just read.  */
0018 call lineout iFID,@.k    /*write the new CSV record (has SUM). */
0019 end   /*k*/              /*stick a fork in it,  we're all done.*/
-------------------------------------------------------------------------
Cross Reference Table Solid Variable Names
-------------------------------------------------------------------------
001 rec              6
002 x                7
003 y                7
004 j                9
005 k                17
-------------------------------------------------------------------------
Cross Reference Table Bizarre Variable Names
-------------------------------------------------------------------------
001 @.               -> newV1.           13
002 $                -> newV2            8 10
003 _                -> newV3            9
