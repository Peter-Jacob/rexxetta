-------------------------------------------------------------------------
Initial REXX INFILE on 23 Mar 2025 at 10:43:07
-------------------------------------------------------------------------
0001 /*REXX program plays the    Bulls & Cows   game with  CBLFs (Carbon Based Life Forms).  */
0002 parse arg ? .;   if datatype(?,'W')  then call random ,,? /*Random seed? Make repeatable*/
0003 L=1234;  H=9876;    call gen@                             /*generate all possibilities. */
0004 do forever;  g=random(L,H); if @.g\==.  then leave /*obtain a random 1st guess.  */
0005 end   /*forever*/                                  /* [↑]  obtain rand 1st guess.*/
0006 $$1= '───── How many bulls and cows were guessed with '; $$2=" ?            [─── or QUIT]"
0007 do until #()<2 | bull==4;   say;   call ask        /*examine @ list;  get answer.*/
0008 do ?=L  to H;     if @.?==.  then iterate      /*is this already eliminated ?*/
0009 call bull#  ?,g                                /*obtain bulls and cows count.*/
0010 if bull\==bulls | cow\==cows  then @.?=.       /*eliminate this possibility. */
0011 end   /*?*/
0012 end   /*until*/
0013 
0014 if #==0  then do;  call serr  "At least one of your responses was invalid.";  exit;    end
0015 say;   say "           ╔═════════════════════════════════════════════════╗"
0016 say "           ║                                                 ║"
0017 say "           ║   Your secret Bulls and Cows number is: " g  "  ║"
0018 say "           ║                                                 ║"
0019 say "           ╚═════════════════════════════════════════════════╝";           say
0020 exit                                             /*stick a fork in it,  we're all done. */
0021 /*──────────────────────────────────────────────────────────────────────────────────────*/
0022 #:     #=0;    do k=L  to H;  if @.k==.  then iterate;  #=#+1;   g=k;  end;       return #
0023 gen@:  @.=.;   do j=L  to H;  if \rep() & pos(0, j)==0  then @.j=j;    end;       return
0024 rep:   do k=1  for 3;  if pos(substr(j, k, 1), j, k+1)\==0  then return 1;   end; return 0
0025 serr:  say;    say  '───── ***error***   '      !     arg(1);                     return
0026 /*──────────────────────────────────────────────────────────────────────────────────────*/
0027 bull#: parse arg n,q;     w=length(n);    bulls=0      /*W: # digits in N;  bull cntr=0 */
0028 do j=1  for w;    if substr(n, j, 1) \== substr(q, j, 1)  then iterate
0029 bulls=bulls+1;    q=overlay(., q, j)     /*bump counter;  disallow for cow*/
0030 end   /*j*/                              /* [↑]  bull count═══════════════*/
0031 cows=0                                          /*set the number of cows to zero.*/
0032 do k=1  for w;    _=substr(n, k, 1);   if pos(_, q)==0  then iterate
0033 cows=cows + 1;    q=translate(q, , _)    /*bump counter;  allow multiple #*/
0034 end   /*k*/                              /* [↑]  cow  count═══════════════*/
0035 return
0036 /*──────────────────────────────────────────────────────────────────────────────────────*/
0037 ask:   do forever; say $$1 g $$2;  pull x 1 bull cow . /*display prompt;  obtain answer.*/
0038 select                                       /* [↑]  PULL capitalizes the args*/
0039 when abbrev('QUIT', x, 1)  then exit         /*the user wants to quit playing.*/
0040 when bull == ''            then != "no numbers were entered."
0041 when cow  == ''            then != "not enough numbers were entered."
0042 when words(x) > 2          then != "too many numbers entered: "              x
0043 when \datatype(bull, 'W')  then != "1st number (bulls) not an integer: "    bull
0044 when \datatype(cow , 'W')  then != "2nd number (cows) not an integer: "     cow
0045 when bull <0 | bull >4     then != "1st number (bulls) not 0 ──► 4: "       bull
0046 when cow  <0 | cow  >4     then != "2nd number (cows) not 0 ──► 4: "        cow
0047 when bull + cow > 4        then != "sum of bulls and cows can't be > 4: "    x
0048 otherwise                       !=
0049 end   /*select*/
0050 if !\==''  then do;  call serr;  iterate;  end  /*prompt the user and try again. */
0051 bull=bull/1;         cow=cow/1;  return         /*normalize bulls & cows numbers.*/
0052 end     /*forever*/
-------------------------------------------------------------------------
Cross Reference Table Solid Variable Names
-------------------------------------------------------------------------
001 n                27
002 q                27 29 33
003 w                27
004 bulls            27 29
005 j                28
006 cows             31 33
007 k                32
008 bull             51
009 cow              51
-------------------------------------------------------------------------
Cross Reference Table Bizarre Variable Names
-------------------------------------------------------------------------
001 $$1              -> newV1            6
002 $$2              -> newV2            6
003 @.               -> newV3.           10 23
004 ?                -> newV4            2 8
005 #                -> newV5            22
006 _                -> newV6            32
